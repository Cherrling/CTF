# 项目描述：

## 题目描述:
* 在这个赛题中，我们将提供一个预训练好的`猫、狗、狐狸`识别模型以及一组`包含这三类图像的数据集`。

* **参赛选手的任务是：** 对这些图像增加微小的扰动，生成攻击图像，使得模型在预测这些经过扰动的攻击图像时出现错误。**目标是：** 让模型将`猫`误识别为`狗`、`狗`误识别为`狐狸`、`狐狸`误识别为`猫`。

## 具体要求如下:

* 选手需要设计一种算法，在不明显改变图像视觉效果的前提下，对图像添加微小扰动，使得提供的`猫`、`狗`、`狐狸`识别模型在预测时出现错误。例如，将原本能够正确识别为`猫`的图像进行扰动后，`模型`会将其错误地分类为`狗`，同理对`狗`图片增加扰动得到的新图片，模型会识别为`狐狸`，对`狐狸`图片增加扰动后得到的新图片，模型会识别为`猫`。

* 为了量化扰动的程度，我们将使用修改后图像与原始图像的相似度作为评判标准。我们会计算每个扰动图像与其对应原始图像的`结构相似性指数（SSIM）`。如果修改后的图像与原图的` SSIM 值低于 0.95`，则认为扰动过大，该攻击样本将不被视为有效的对抗性样本。

* 对于满足相似度条件的图像，我们将使用提供的`猫`、`狗`、`狐狸`识别模型进行预测。如果模型预测结果满足对应的攻击映射，则视为一次成功的攻击，选手将获得 1 分。选手需要在成功攻击至少` 80% `的样本，即产生至少` 80% `满足相似度条件且能够成功欺骗模型的对抗性样本，才能获得题目的 `flag`。


## 项目细节：

1. **数据类别标签映射**：

    - 目标标签映射：

        ```python
        target_mapping = {
            0: 1,  # 原标签: cat -> 目标标签: dog
            1: 2,  # 原标签: dog -> 目标标签: fox
            2: 0   # 原标签: fox -> 目标标签: cat
        }
        ```

2. **数据和模型**：

   - 发放的数据中包含图片文件和 `预训练模型 ckpt_densenet121_catdogfox_classify.pth`。

    - 预训练模型的读取如下：

        ```python

        model = models.densenet121(pretrained=True)
        num_ftrs = model.classifier.in_features
        model.classifier = nn.Sequential(
            nn.Linear(num_ftrs, 500),
            nn.Linear(500, 3) 
        )

        model.load_state_dict(torch.load(PATH, map_location=device))
        model = model.to(device)
        ```



    - 模型的 `label` 映射: `{"cat":0,"dog":1,"fox":2}`

    - 数据目录结构如下：

        ```
        adv_image
            |____cat
            |    |______cat_000.jpg
            |    |______cat_001.jpg
            |____dog
            |    |______dog_000.jpg
            |    |______dog_001.jpg
            |____fox
            |    |______fox_000.jpg
            |    |______fox_001.jpg
        ```

   - 要求选手对图片增加扰动，将扰动后的攻击图片保存下来，保存下来的攻击图片，可以达到让模型分类错误的效果`（dog 图片识别为fox，fox图片识别为cat，cat图片识别为dog）`。

3. **提交要求**：

    - 选手需要把增加扰动后得到的新图片(攻击图片)，按照规定的格式进行上传提交(在平台下载上传时的文件结构目录 update.tar.gz)，将经过扰动后的攻击图像存放在对应的文件夹下，修改后图片文件名称需要和原始图像名称保持一致，不要修改。
    
    - 将图片文件存放到`update`对应的`cat`、`dog`、`fox` 目录下。可以用如下命令创建 .tar.gz 包，然后上传:

            tar -zcf xxxxx.tar.gz update

    - 目录结构如下（修改后的图片文件名称需要和原始图片名称保持一致）：

            xxxx.tar.gz
            |____update
                |____cat
                    |______**.jpg
                |____dog
                    |______**.jpg
                |____fox
                    |______**.jpg

## 评分标准：

1. **相似度**：
   - 生成的对抗图像和原始图像之间的结构相似度（SSIM）需要在 95% 以内。
   
2. **攻击成功率**：
   - 攻击成功率达到 80%（即生成的对抗样本中有 80% 能够欺骗模型并满足相似度要求）。

3. **成功满足上述条件即可获取比赛的 flag。**
