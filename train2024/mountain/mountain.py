import numpy as np
from Crypto.Util.Padding import pad

from secret import K, flag

def enc_block(plain):
    plain = np.matrix(plain)
    cipher = np.matmul(plain, K) % 127
    return cipher.tolist()[0]

def enc(plain):
    plain = pad(plain, 8, 'pkcs7')
    res = []

    for x in range(0, len(plain), 8):
        block = list(plain[x: x+8])
        res += enc_block(block)
    
    return bytes(res)

assert flag[:180] == b'We choose to go to the Moon. We choose to go to the Moon... We choose to go to the Moon in this decade and do the other things, not because they are easy, but because they are hard'

print(enc(flag).hex())



# 28452235270529613e707821653f74021f236f753434435d023372514d4362690b5f760958252d4973331f1f367e37691e226a23530a032f20776c356f1e23496a7348743c5439551c6c452670051c70260e09190a0a05382448031c2909331363544b0035251775707d407e3e09243b55631f6f58234e6a1f170035634f2f3c7e102b7e74645c502a376f1e0f5a3d751d79146322367568385d1a5545712b1e486e2e2d6e5b7e644c175b2e7b103a29613e793c70600e41396c69034c38787411483c220e0e0a136c7b432f60085a21660f07515e25680f17531d3d447b6d302f7615592e606a7a4a01100137402a1c7d0b443d2a0c4515385f3b2d483c6b0b360e5e19083f08026876122e3414457e1759664b60064b33214f084327126201116725556b31625f5b357d6d20472b356b5b0b03076b225547502b6b703e716b326f1918324766652072694f0e5268324f2b3359763b714e73205e036e626d1e4734555a0365126c6453610763661f1611597d460b18281f5106033d417602113904173d7e054f5f08156e596d5e3f32397762714f7d015046480a721f2311384010016a2b321b69016f46545d3236066651190758675978